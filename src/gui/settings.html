<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Shake - Settings</title>
    <link rel="shortcut icon" type="image/png" href="../resources/IconLogo.png">
    <style>
        body{font-family:"Arial", "Helvetica", sans-serif;font-size:14px;font-weight:400;line-height:1.4;background-color:#FFF;padding:10px 20px;color:#525252;margin:0}
        h2{font-weight:300;font-size:28px;margin:5px 0 20px}
        h4{margin-top:25px}
        p{font-size:12px}
        hr{margin:0;border:none;border-top:1px solid #999}
        blockquote{margin-left:10px}
        select{font-family:inherit;width:176px;height:30px;font-size:14px;line-height:1.4;padding:5px 14px 4px;margin-top:5px;color:#525252;border:1px solid #ededed;overflow:hidden;background-color:white;-webkit-border-radius:4px;border-radius:4px;-webkit-border-radius:4px;border-radius:4px;margin-bottom:10px}
        select:focus{outline:none}
        button{position:absolute;top:10px;right:20px;font:inherit;padding:5px 14px 4px;margin:10px 0 10px;color:#FFF;border:1px solid #4cae4c;background:#5CB85C;text-align:center;cursor:pointer;-webkit-border-radius:4px;border-radius:4px;display:inline-block}
        button:hover,button:active{border:1px solid #4cae4c;background:#63bb63}
    </style>
    <script>
        var fs = require('fs');
        var path = require('path');
        var logger = require('lumios-toolkit');
        var locale = require('../resources/lang.json');
        var settings = require('../settings.json');
        var lang = settings.lang;
		var settingsPath = path.join(__dirname, '../', 'settings.json');
        var settingsFile = {"lang": "en", "min_alert": "35", "first_run": false, "night_mode": true, "dev_mode": true};

        function save() {
            try {
                var form = document.getElementById("settings");
                var settings = {};
                settings["lang"] = form["lang"].value;
                settings["min_alert"] = form["min_alert"].value;
                settings["first_run"] = false;
                settings["night_mode"] = form["night_mode"].checked;
				settings["dev_mode"] = form["dev_mode"].checked;
                fs.writeFile(settingsPath, JSON.stringify(settings));
            } catch(err) {
                alert("There was an error saving your settings: " + err);
                logger.error('Error: ' + err);
            } finally {
                alert("Please restart Shake to apply your changes.");
                logger.success('Web > Saved settings');
                window.close();
			}
        }
    </script>
</head>
<body>
    <h2>Settings</h2>
    <hr>

    <form action="javascript:save()" id="settings">
		<h4><span id="lang">Language</a></h4>
		<blockquote>
			<label><input type="radio" name="lang" value="en" checked> English</label><br>
			<label><input type="radio" name="lang" value="ja"> 日本語</label>
		</blockquote>

    	<h4>Minimum Alert Size</h4>

		<p>Choose a Minimum Magnitude Size to be notified of.<br>
        (You will only be notified of Earthquakes of this size and higher.)</p>

        <select name="min_alert">
            <option value="35" selected>3.5</option>
            <option value="40">4.0</option>
            <option value="45">4.5</option>
            <option value="50">5.0</option>
            <option value="55">5.5</option>
            <option value="60">6.0</option>
            <option value="65">6.5</option>
            <option value="70">7.0</option>
        </select>

        <br><br><hr>

        <h4>Night Mode</h4>
        <p>If enabled, Notification Sounds will be muted between Midnight and 7am.<br>
        (This setting is ignored if an Earthquake is above Magnitude 6)</p>

        <label><input type="checkbox" name="night_mode"> Enable</label>

        <br>

		<h4>Development Mode</h4>
		<p>If enabled, you will receive fake quakes regularly, in order to test the program.<br>
		(Please do not enable this option if you are not a developer.)</p>

		<label><input type="checkbox" name="dev_mode"> Enable</label>

		<br><br>

        <button value="submit">Save</button>
    </form>
</body>
</html>
